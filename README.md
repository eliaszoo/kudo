# å¥–åŠ±ç³»ç»Ÿ - é¡¹ç›®æ¦‚è§ˆ

åŸºäºéœ€æ±‚æ–‡æ¡£å®ç°çš„å®Œæ•´å¥–åŠ±ç³»ç»Ÿï¼ŒåŒ…å«åç«¯APIæœåŠ¡å’Œå‰ç«¯ç®¡ç†ç•Œé¢ã€‚

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
reward-system/
â”œâ”€â”€ frontend/                    # å‰ç«¯é¡¹ç›® (React + TypeScript + Vite)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/         # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/              # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ stores/             # çŠ¶æ€ç®¡ç† (Zustand)
â”‚   â”‚   â”œâ”€â”€ App.tsx             # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ main.tsx            # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ package.json            # å‰ç«¯ä¾èµ–é…ç½®
â”‚   â”œâ”€â”€ vite.config.ts          # Vite é…ç½®
â”‚   â””â”€â”€ tailwind.config.js      # Tailwind CSS é…ç½®
â”‚
â”œâ”€â”€ backend/                     # åç«¯é¡¹ç›® (Go + MySQL)
â”‚   â”œâ”€â”€ cmd/
â”‚   â”‚   â”œâ”€â”€ server/             # ä¸»æœåŠ¡å…¥å£
â”‚   â”‚   â””â”€â”€ migrate/            # æ•°æ®åº“è¿ç§»å·¥å…·
â”‚   â”œâ”€â”€ internal/
â”‚   â”‚   â”œâ”€â”€ api/                # API å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ config/             # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ db/                 # æ•°æ®åº“æ¨¡å‹
â”‚   â”‚   â””â”€â”€ services/           # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ migrations/             # æ•°æ®åº“è¿ç§»è„šæœ¬
â”‚   â”œâ”€â”€ go.mod                  # Go ä¾èµ–é…ç½®
â”‚   â””â”€â”€ .env.example            # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚
â””â”€â”€ éœ€æ±‚.md                      # éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18+ (å‰ç«¯)
- Go 1.21+ (åç«¯)
- MySQL 8.0+ (æ•°æ®åº“)
- pnpm (åŒ…ç®¡ç†å™¨)

### 1. å®‰è£…ä¾èµ–

```bash
# å‰ç«¯ä¾èµ–
cd frontend
pnpm install

# åç«¯ä¾èµ–
cd ../backend
go mod download
```

### 2. æ•°æ®åº“è®¾ç½®

```bash
# åˆ›å»ºæ•°æ®åº“
mysql -u root -p < migrations/001_initial_schema.sql

# æˆ–è€…ä½¿ç”¨è¿ç§»å·¥å…·
cd backend
go run cmd/migrate/main.go
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

```bash
# åç«¯é…ç½®
cp backend/.env.example backend/.env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½®æ•°æ®åº“è¿æ¥ç­‰ä¿¡æ¯
```

### 4. å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨åç«¯æœåŠ¡ (ç«¯å£ 8080)
cd backend
go run cmd/server/main.go

# å¯åŠ¨å‰ç«¯æœåŠ¡ (ç«¯å£ 3000)
cd frontend
pnpm dev
```

## ğŸ“‹ æ ¸å¿ƒåŠŸèƒ½

### âœ… å·²å®ç°åŠŸèƒ½

#### åç«¯API (Go)
- [x] RESTful API è®¾è®¡
- [x] å¤šç”¨æˆ·å®¶åº­ç®¡ç†
- [x] å¥–åŠ±ç±»å‹é…ç½®ï¼ˆé›¶èŠ±é’±ã€æ—¶é—´ã€ç§¯åˆ†ã€è‡ªå®šä¹‰ï¼‰
- [x] å¥–åŠ±æˆäºˆä¸æ¶ˆè´¹
- [x] ä½™é¢æŸ¥è¯¢ä¸äº¤æ˜“è®°å½•
- [x] äº‹åŠ¡ä¸€è‡´æ€§ä¸å¹‚ç­‰æ€§
- [x] æ•°æ®åº“è¿ç§»è„šæœ¬
- [x] å•å…ƒæµ‹è¯•

#### å‰ç«¯ç•Œé¢ (React)
- [x] ç°ä»£åŒ–UIè®¾è®¡
- [x] å“åº”å¼å¸ƒå±€
- [x] ä»ªè¡¨æ¿æ¦‚è§ˆ
- [x] å¥–åŠ±ç±»å‹ç®¡ç†
- [x] äº¤æ˜“è®°å½•æŸ¥çœ‹
- [x] ä½™é¢ç»Ÿè®¡å±•ç¤º
- [x] çŠ¶æ€ç®¡ç† (Zustand)

#### æ•°æ®åº“ (MySQL)
- [x] å®Œæ•´çš„è¡¨ç»“æ„è®¾è®¡
- [x] äº‹åŠ¡å¤„ç†ä¸å¹¶å‘æ§åˆ¶
- [x] ç´¢å¼•ä¼˜åŒ–
- [x] æµ‹è¯•æ•°æ®

### ğŸš§ å¾…å®ç°åŠŸèƒ½
- [ ] MCPå¤§æ¨¡å‹é›†æˆï¼ˆè‡ªç„¶è¯­è¨€è§£æï¼‰
- [ ] å¾®ä¿¡æ¶ˆæ¯æ¥å…¥ï¼ˆWebhookï¼‰
- [ ] è¯­éŸ³/å›¾ç‰‡æ¶ˆæ¯å¤„ç†
- [ ] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²é…ç½®
- [ ] æ€§èƒ½ä¼˜åŒ–

## ğŸ”§ APIæ¥å£

### æ ¸å¿ƒç«¯ç‚¹

```
POST   /api/v1/reward_types          # åˆ›å»ºå¥–åŠ±ç±»å‹
POST   /api/v1/rewards/grant         # æˆäºˆå¥–åŠ±
POST   /api/v1/rewards/spend         # æ¶ˆè´¹å¥–åŠ±
GET    /api/v1/balances              # æŸ¥è¯¢ä½™é¢
GET    /api/v1/transactions          # äº¤æ˜“è®°å½•
POST   /api/v1/wechat                # å¾®ä¿¡æ¶ˆæ¯å¤„ç†
POST   /api/v1/mcp/tools             # MCPå·¥å…·è°ƒç”¨
```

### è®¤è¯æ–¹å¼
- Bearer Token (å¼€å‘ç¯å¢ƒ)
- å¾®ä¿¡å¼€æ”¾å¹³å°éªŒè¯ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

## ğŸ§ª æµ‹è¯•

```bash
# åç«¯æµ‹è¯•
cd backend
go test ./...

# å‰ç«¯æµ‹è¯•
cd frontend
pnpm test
```

## ğŸ“Š æ•°æ®æ¨¡å‹

### ä¸»è¦è¡¨ç»“æ„
- `families` - å®¶åº­ä¿¡æ¯
- `users` - ç”¨æˆ·ä¿¡æ¯ï¼ˆç›‘æŠ¤äºº/å­©å­ï¼‰
- `reward_types` - å¥–åŠ±ç±»å‹å®šä¹‰
- `accounts` - å­©å­è´¦æˆ·ï¼ˆæŒ‰å¥–åŠ±ç±»å‹ï¼‰
- `transactions` - äº¤æ˜“è®°å½•
- `audit_logs` - å®¡è®¡æ—¥å¿—

## ğŸ”’ å®‰å…¨ç‰¹æ€§
- æ•æ„Ÿä¿¡æ¯åŠ å¯†å­˜å‚¨
- æƒé™æ§åˆ¶ï¼ˆç›‘æŠ¤äºº/å­©å­è§’è‰²ï¼‰
- äº‹åŠ¡ä¸€è‡´æ€§ä¿è¯
- å¹‚ç­‰æ€§å¤„ç†
- è¾“å…¥éªŒè¯ä¸æ¸…ç†

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### æˆäºˆå¥–åŠ±
```bash
curl -X POST http://localhost:8080/api/v1/rewards/grant \
  -H "Authorization: Bearer your-token" \
  -H "Content-Type: application/json" \
  -d '{
    "family_id": 1,
    "child_id": 2,
    "reward_type_id": 1,
    "value": 10000,
    "note": "å®Œæˆä½œä¸š",
    "idempotency_key": "unique-key"
  }'
```

### æŸ¥è¯¢ä½™é¢
```bash
curl -X GET "http://localhost:8080/api/v1/balances?family_id=1&child_id=2&reward_type_id=1" \
  -H "Authorization: Bearer your-token"
```

## ğŸ“ å¼€å‘è®¡åˆ’

1. **Phase 1** (å·²å®Œæˆ)
   - âœ… åŸºç¡€æ¶æ„æ­å»º
   - âœ… æ ¸å¿ƒAPIå®ç°
   - âœ… å‰ç«¯ç•Œé¢å¼€å‘
   - âœ… æ•°æ®åº“è®¾è®¡

2. **Phase 2** (è¿›è¡Œä¸­)
   - ğŸ”„ MCPå¤§æ¨¡å‹é›†æˆ
   - ğŸ”„ å¾®ä¿¡æ¶ˆæ¯æ¥å…¥
   - ğŸ“‹ æµ‹è¯•ç”¨ä¾‹å®Œå–„

3. **Phase 3** (è®¡åˆ’ä¸­)
   - ğŸ“‹ æ€§èƒ½ä¼˜åŒ–
   - ğŸ“‹ éƒ¨ç½²é…ç½®
   - ğŸ“‹ æ–‡æ¡£å®Œå–„

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ’¬ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤ Issue
- å‘é€é‚®ä»¶
- å¾®ä¿¡è®¨è®º

---

**Happy Coding! ğŸ‰**